<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThreeCards</title>
    <link rel="stylesheet" href="style.css">
  </head>

  <body>
    <h1>THREE CARDS</h1>
    <button id='test'>TEST</button>
    <div id="images"></div>
  </body>

  <script>
    const testButton = document.getElementById('test');
    testButton.addEventListener('click', deal);
    function deal() {
      const imageBox = document.getElementById('images')
      for (let i = 0; i < 3; i++) {
        const card = document.createElement('IMG')
        card.setAttribute('src', `/images/back.png`)
        card.addEventListener('click', testClick)
        imageBox.appendChild(card)
      }
      const cards = document.querySelector('.card')
    }
    function testClick(e) {
      fetch('/createCard', {
        method: 'POST',
        headers: {
          "Content-Type": "Application/JSON"
        },
        body: JSON.stringify({ key: 98 })
      }).then((data) => data.json())
        .then((result) => {
          if (result.key > 78) {
            e.target.classList.add('reversed')
          }
          e.target.setAttribute('src', result.imgUrl)
        }).catch(err => console.log(err))
    };
  </script>

</html>